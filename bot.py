import logging
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

BOT_TOKEN = "8238117273:AAG0URTEil-1bGyBmKOucgEB1w7hXSKSG9A"

logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

def main_menu():
    keyboard = [
        ["🎯База танков"],
        ["🔍Оборудование для танков"],
        ["📊 О боте", "❓ Помощь"]
    ]
    return ReplyKeyboardMarkup(keyboard, resize_keyboard=True)

def tanks_menu():
    keyboard = [
        ["⚔️ Тяжёлые танки", "🎯 ПТ-САУ"],
        ["🚗 Лёгкие танки", "⚡ Средние танки"], 
        ["🎆 Артиллерия", "🔙 Назад"]
    ]
    return ReplyKeyboardMarkup(keyboard, resize_keyboard=True)

def nations_menu():
    keyboard = [
        ["🇷🇺 СССР", "🇺🇸 США", "🇩🇪 Германия"],
        ["🇬🇧 Великобритания", "🇫🇷 Франция", "🇯🇵 Япония"],
        ["🇨🇳 Китай", "🇨🇿 Чехия", "🇵🇱 Польша"], 
        ["🇸🇪 Швеция", "🇮🇹 Италия", "⚙️ Сборная"],
        ["🔙 Назад"]
    ]
    return ReplyKeyboardMarkup(keyboard, resize_keyboard=True)

TANK_EQUIPMENT = {
    "⚔️ Тяжёлые танки": {
        "title": "⚔️ ТЯЖЁЛЫЕ ТАНКИ",
        "description": "Мощные машины с хорошим бронированием",
        "tanks": {
            "ИС-7": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция\n• 🎮 Стабилизатор наводки", "bonus": "📈 +10% к перезарядке\n🌟 +5% ко всем характеристикам\n🎯 +20% к стабилизации", "playstyle": "Универсальная сборка для любых ситуаций"}]},
            "Об. 277": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Агрессивная игра, прорывы флангов"}]},
            "Об. 705A": {"nation": "🇷🇺 СССР", "setups": [{"name": "🛡️ ТАНКОВАНИЕ", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🎯 Досылатель", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n📈 +10% к перезарядке", "playstyle": "Использование обратного наклона брони"}]},
            "ИС-4": {"nation": "🇷🇺 СССР", "setups": [{"name": "🛡️ ОБОРОНА", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🌬️ Улучшенная вентиляция", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n🌟 +5% ко всем характеристикам", "playstyle": "Танкование на городских картах"}]},
            "T110E5": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра на любой дистанции"}]},
            "T57 Heavy Tank": {"nation": "🇺🇸 США", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Реализация урона клипом"}]},
            "Maus": {"nation": "🇩🇪 Германия", "setups": [{"name": "🛡️ ТАНКОВАНИЕ", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🌬️ Улучшенная вентиляция", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n🌟 +5% ко всем характеристикам", "playstyle": "Максимальное использование брони"}]},
            "E-100": {"nation": "🇩🇪 Германия", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Нанесение максимального урона"}]},
            "Type 5 Heavy": {"nation": "🇯🇵 Япония", "setups": [{"name": "🛡️ ТАНКОВАНИЕ", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🎯 Досылатель", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n📈 +10% к перезарядке", "playstyle": "Танкование с использованием HE снарядов"}]},
            "Super Conqueror": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 ХУЛДАУН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Игра от башни и хулдаун"}]},
            "AMX 50 B": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ ПОДДЕРЖКА", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Поддержка и реализация дамага"}]},
            "Vz. 55": {"nation": "🇨🇿 Чехия", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Агрессивная игра с использованием двухорудийного режима"}]},
            "60TP Lewandowskiego": {"nation": "🇵🇱 Польша", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Нанесение максимального урона альфа-страйком"}]},
            "Rinoceronte": {"nation": "🇮🇹 Италия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Использование механизма перезарядки"}]},
            "113": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра с хорошим ДПМ"}]},
            "WZ-111 model 5A": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра с хорошей подвижностью"}]},
            "BZ-75": {"nation": "🇨🇳 Китай", "setups": [{"name": "⚡ РАКЕТНЫЙ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Использование ракетных ускорителей"}]},
            "BZ-176": {"nation": "🇨🇳 Китай", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Нанесение максимального урона"}]},
            "BZ-74-1": {"nation": "🇨🇳 Китай", "setups": [{"name": "⚡ РАКЕТНЫЙ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Использование ракетных ускорителей"}]},
            "116-F3": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "WZ-111 Qilin": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 ПРЕМИУМ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Премиум версия WZ-111"}]},
            "113 Beijing Opera": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "AMX M4 mle. 54": {"nation": "🇫🇷 Франция", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Projet 57": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ ПОДДЕРЖКА", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Поддержка и реализация дамага"}]},
            "Projet 57 Ampere": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ ПОДДЕРЖКА", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Поддержка и реализация дамага"}]},
            "FV215b": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 ХУЛДАУН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Игра от башни и хулдаун"}]},
            "T95/FV4201 Chieftain": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 ХУЛДАУН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Игра от башни и хулдаун"}]},
            "FV242B Condor": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Type 71": {"nation": "🇯🇵 Япония", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "СТ-II": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ДВУХОРУДИЙНЫЙ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Использование двухорудийного режима"}]},
            "Объект 780": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Объект 279 ранний": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Агрессивная игра на передовой"}]},
            "Объект 260": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Агрессивная игра, прорывы флангов"}]},
            "ИС-7 «Драгун»": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция\n• 🎮 Стабилизатор наводки", "bonus": "📈 +10% к перезарядке\n🌟 +5% ко всем характеристикам\n🎯 +20% к стабилизации", "playstyle": "Универсальная сборка для любых ситуаций"}]},
            "Объект 718Б": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Агрессивная игра"}]},
            "Pz.Kpfw. VII": {"nation": "🇩🇪 Германия", "setups": [{"name": "🛡️ ТАНКОВАНИЕ", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🌬️ Улучшенная вентиляция", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n🌟 +5% ко всем характеристикам", "playstyle": "Максимальное использование брони"}]},
            "Kampfpanzer 07 P(E)": {"nation": "🇩🇪 Германия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "VK 72.01 (K)": {"nation": "🇩🇪 Германия", "setups": [{"name": "🛡️ ОБОРОНА", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🎯 Досылатель", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n📈 +10% к перезарядке", "playstyle": "Оборона ключевых направлений"}]},
            "E 100 Feuerbär": {"nation": "🇩🇪 Германия", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Нанесение максимального урона"}]},
            "M-V-Y": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Н-3": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Gothic Warrior": {"nation": "🇨🇿 Чехия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Kranvagn": {"nation": "🇸🇪 Швеция", "setups": [{"name": "🎯 ХУЛДАУН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Игра от башни и хулдаун"}]},
            "Czołg Pancernik wz.46": {"nation": "🇵🇱 Польша", "setups": [{"name": "🛡️ ТАНКОВАНИЕ", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🎯 Досылатель", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n📈 +10% к перезарядке", "playstyle": "Танкование"}]},
            "Czołg (P) wz.46 Wiedźmak": {"nation": "🇵🇱 Польша", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Astron-FL": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Grayhound": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]},
            "Orso": {"nation": "🇮🇹 Италия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% к перезарядке\n🎯 +20% стабилизация\n🌟 +5% ко всем характеристикам", "playstyle": "Универсальная игра"}]}
        }
    },
    "⚡ Средние танки": {
        "title": "⚡ СРЕДНИЕ ТАНКИ",
        "description": "Универсальные машины на любой случай", 
        "tanks": {
            "T-62A": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 ДПМ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Максимизация урона в минуту"}]},
            "Объект 907": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра на любой дистанции"}]},
            "Объект 140": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра на любой дистанции"}]},
            "Объект 430У": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Агрессивная игра на передовой"}]},
            "K-91": {"nation": "🇷🇺 СССР", "setups": [{"name": "🔍 ПОДДЕРЖКА", "equipment": "• 👁️ Просветленная оптика\n• 🎯 Досылатель\n• 🎮 Стабилизатор наводки", "bonus": "👀 +10% обзор\n📈 +10% перезарядка\n🎯 +20% стабилизация", "playstyle": "Поддержка со второй линии"}]},
            "T-22 ср.": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Агрессивная игра с использованием брони"}]},
            "E 50 Ausf. M": {"nation": "🇩🇪 Германия", "setups": [{"name": "⚡ УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра с возможностью тарана"}]},
            "Leopard 1": {"nation": "🇩🇪 Германия", "setups": [{"name": "🔍 СНАЙПЕРСКАЯ", "equipment": "• 👁️ Просветленная оптика\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "👀 +10% обзор\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Игра от точности и обзора"}]},
            "Erich Konzept I": {"nation": "🇩🇪 Германия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "M48A5 Patton": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "M60": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "T95E6": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "121": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра с хорошим альфа-уроном"}]},
            "Царь обезьян": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "121B": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра с отличными характеристиками"}]},
            "DZT-159": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Bat.-Châtillon 25 t": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ ФЛАНГИ", "equipment": "• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% перезарядка\n🌟 +5% все характеристики\n⚡ +10% скорость сведения", "playstyle": "Фланговая игра и реализация урона"}]},
            "AMX 30 B": {"nation": "🇫🇷 Франция", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Projet Murat": {"nation": "🇫🇷 Франция", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Centurion Action X": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра от башни"}]},
            "Concept No. 5": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Nemesis": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "STB-1": {"nation": "🇯🇵 Япония", "setups": [{"name": "🎯 ХУЛДАУН", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Использование гидропневматической подвески"}]},
            "TVP T 50/51": {"nation": "🇨🇿 Чехия", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Реализация урона клипом"}]},
            "UDES 15/16": {"nation": "🇸🇪 Швеция", "setups": [{"name": "🎯 ХУЛДАУН", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Использование наклона корпуса и сильной башни"}]},
            "CS-63": {"nation": "🇵🇱 Польша", "setups": [{"name": "⚡ РЕЙДЫ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Использование турбо-режима для захвата позиций"}]},
            "CS-63 Wilk": {"nation": "🇵🇱 Польша", "setups": [{"name": "⚡ РЕЙДЫ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Использование турбо-режима для захвата позиций"}]},
            "Progetto M40 mod. 65": {"nation": "🇮🇹 Италия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Гибкая игра с механизмом перезарядки"}]},
            "Lion": {"nation": "🇮🇹 Италия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Carro da Combattimento 45 t": {"nation": "🇮🇹 Италия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Merkava LP": {"nation": "🇮🇱 Израиль", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "T-54D": {"nation": "⚙️ Сборная", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎮 Стабилизатор наводки\n• 🎯 Досылатель\n• 🌬️ Улучшенная вентиляция", "bonus": "🎯 +20% стабилизация\n📈 +10% перезарядка\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]}
        }
    },
    "🚗 Лёгкие танки": {
        "title": "🚗 ЛЁГКИЕ ТАНКИ",
        "description": "Быстрые разведчики и истребители",
        "tanks": {
            "T-100 LT": {"nation": "🇷🇺 СССР", "setups": [{"name": "🔍 РАЗВЕДКА", "equipment": "• 👁️ Просветленная оптика\n• 🔭 Стереотруба\n• 🕸️ Маскировочная сеть", "bonus": "👀 +10% обзор\n🔭 +25% обзор в неподвижности\n🕸️ +15% маскировка", "playstyle": "Пассивная разведка и маскировка"}]},
            "EBR 105": {"nation": "🇫🇷 Франция", "setups": [{"name": "🔍 АКТИВНЫЙ СВЕТ", "equipment": "• 👁️ Просветленная оптика\n• ⚡ Усиленные приводы наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "👀 +10% обзор\n⚡ +10% скорость сведения\n🌟 +5% все характеристики", "playstyle": "Активный свет и быстрые рейды"}]},
            "AMX 13 105": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Охота за отдельными целями и реализация клипов"}]},
            "Rheinmetall Panzerwagen": {"nation": "🇩🇪 Германия", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 👁️ Просветленная оптика\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "👀 +10% обзор\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра разведка + поддержка"}]},
            "WZ-132-1": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 👁️ Просветленная оптика\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "👀 +10% обзор\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра разведка + поддержка"}]},
            "Manticore": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🔍 ПАССИВНЫЙ СВЕТ", "equipment": "• 👁️ Просветленная оптика\n• 🔭 Стереотруба\n• 🕸️ Маскировочная сеть", "bonus": "👀 +10% обзор\n🔭 +25% обзор в неподвижности\n🕸️ +15% маскировка", "playstyle": "Пассивная разведка с максимальной маскировкой"}]},
            "XM551 Sheridan": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 👁️ Просветленная оптика\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "👀 +10% обзор\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра с возможностью использования ПТУР"}]}
        }
    },
    "🎯 ПТ-САУ": {
        "title": "🎯 ПТ-САУ", 
        "description": "Противотанковые самоходные установки",
        "tanks": {
            "Объект 268 Вариант 5": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 👁️ Просветленная оптика", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n👀 +10% обзор", "playstyle": "Универсальная игра на средней дистанции"}]},
            "Объект 268": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 👁️ Просветленная оптика", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n👀 +10% обзор", "playstyle": "Универсальная игра на средней дистанции"}]},
            "Объект 268 Вариант 4": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• ⚡ Усиленные приводы наводки", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n⚡ +10% скорость сведения", "playstyle": "Агрессивная игра на передовой"}]},
            "WT E100 Оруженосец": {"nation": "🇷🇺 СССР", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Реализация урона клипом"}]},
            "Grille 15": {"nation": "🇩🇪 Германия", "setups": [{"name": "🔍 СНАЙПЕРСКАЯ", "equipment": "• 👁️ Просветленная оптика\n• 🔭 Стереотруба\n• 🎮 Стабилизатор наводки", "bonus": "👀 +10% обзор\n🔭 +25% обзор в неподвижности\n🎯 +20% стабилизация", "playstyle": "Игра от точности и обзора"}]},
            "СУ-122B": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Jagdpanzer E100": {"nation": "🇩🇪 Германия", "setups": [{"name": "🛡️ ОБОРОНА", "equipment": "• 🎯 Досылатель\n• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска", "bonus": "📈 +10% перезарядка\n⚡ Быстрый ремонт\n💪 +20% прочность подвески", "playstyle": "Оборона ключевых направлений"}]},
            "Waffenträger auf E100": {"nation": "🇩🇪 Германия", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона"}]},
            "Sturmtiger": {"nation": "🇩🇪 Германия", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона"}]},
            "T110E3": {"nation": "🇺🇸 США", "setups": [{"name": "🛡️ ШТУРМОВАЯ", "equipment": "• 🎯 Досылатель\n• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска", "bonus": "📈 +10% перезарядка\n⚡ Быстрый ремонт\n💪 +20% прочность подвески", "playstyle": "Штурм позиций с хорошим бронированием"}]},
            "T110E4": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра с вращающейся башней"}]},
            "XМ57": {"nation": "🇺🇸 США", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "WZ-113G FT": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "114 SP2": {"nation": "🇨🇳 Китай", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "AMX 50 Foch (155)": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Реализация урона клипом"}]},
            "AMX 50 Foch B": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Реализация урона клипом"}]},
            "120 AC «Gendarme»": {"nation": "🇫🇷 Франция", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "FV215b (183)": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона"}]},
            "FV4005 Stage II": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона"}]},
            "FV217 Badger": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "🛡️ ОБОРОНА", "equipment": "• 🎯 Досылатель\n• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска", "bonus": "📈 +10% перезарядка\n⚡ Быстрый ремонт\n💪 +20% прочность подвески", "playstyle": "Оборона ключевых направлений"}]},
            "Ho-Ri 3": {"nation": "🇯🇵 Япония", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Strv 103B": {"nation": "🇸🇪 Швеция", "setups": [{"name": "🎯 СНАЙПЕРСКАЯ", "equipment": "• 👁️ Просветленная оптика\n• 🔭 Стереотруба\n• 🕸️ Маскировочная сеть", "bonus": "👀 +10% обзор\n🔭 +25% обзор в неподвижности\n🕸️ +15% маскировка", "playstyle": "Игра от обзора и маскировки в осадном режиме"}]},
            "Wz.70 Żubr": {"nation": "🇵🇱 Польша", "setups": [{"name": "🎯 УНИВЕРСАЛЬНАЯ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Универсальная игра"}]},
            "Controcarro 3 Minotauro": {"nation": "🇮🇹 Италия", "setups": [{"name": "🛡️ ТАНКОВАНИЕ", "equipment": "• 🔧 Ремкомплект\n• 🛡️ Усиленная подвеска\n• 🎯 Досылатель", "bonus": "⚡ Быстрый ремонт\n💪 +20% прочность подвески\n📈 +10% к перезарядке", "playstyle": "Использование брони и механизма перезарядки"}]}
        }
    },
    "🎆 Артиллерия": {
        "title": "🎆 АРТИЛЛЕРИЯ",
        "description": "Самоходные артиллерийские установки", 
        "tanks": {
            "Объект 261": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 ТОЧНОСТЬ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Точная стрельба с быстрой перезарядкой"}]},
            "Объект 261 Вариант 4": {"nation": "🇷🇺 СССР", "setups": [{"name": "🎯 ТОЧНОСТЬ", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Точная стрельба с быстрой перезарядкой"}]},
            "G.W. E 100": {"nation": "🇩🇪 Германия", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона"}]},
            "T92 HMC": {"nation": "🇺🇸 США", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона за выстрел"}]},
            "Bat.-Châtillon 155 58": {"nation": "🇫🇷 Франция", "setups": [{"name": "⚡ КЛИПЕР", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Реализация урона клипом"}]},
            "Conqueror Gun Carriage": {"nation": "🇬🇧 Великобритания", "setups": [{"name": "💥 УРОН", "equipment": "• 🎯 Досылатель\n• 🎮 Стабилизатор наводки\n• 🌬️ Улучшенная вентиляция", "bonus": "📈 +10% перезарядка\n🎯 +20% стабилизация\n🌟 +5% все характеристики", "playstyle": "Нанесение максимального урона"}]}
        }
    }
}

def search_tanks(query):
    query = query.lower().strip()
    results = []
    for class_name, class_data in TANK_EQUIPMENT.items():
        if "tanks" in class_data:
            for tank_name, tank_data in class_data["tanks"].items():
                if query in tank_name.lower():
                    results.append({"class": class_name, "tank_name": tank_name, "data": tank_data})
    return results

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        user = update.message.from_user
        welcome_text = f"""🎮 Добро пожаловать, {user.first_name}!
⚡ Бот сборок оборудования для Мира Танков

Теперь с полной базой танков 10 уровня!

• ⚔️ Тяжёлые танки - 48 танков
• ⚡ Средние танки - 32 танка  
• 🚗 Лёгкие танки - 7 танков
• 🎯 ПТ-САУ - 24 танка
• 🎆 Артиллерия - 6 танков

Выберите «🎯База танков» для просмотра по классам или «🔍Оборудование для танков» для поиска оборудования."""
        await update.message.reply_text(welcome_text, reply_markup=main_menu())
    except Exception as e:
        logger.error(f"Error in start: {e}")

async def handle_search(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        if update.message.text == "🔍Оборудование для танков":
            await update.message.reply_text("🔍 Введите название танка:\n\nПример: ИС-7, Объект 140, T110E5")
            context.user_data['waiting_for_tank_name'] = True
    except Exception as e:
        logger.error(f"Error in handle_search: {e}")

async def handle_tank_search(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        if context.user_data.get('waiting_for_tank_name'):
            tank_name = update.message.text
            results = search_tanks(tank_name)
            if not results:
                await update.message.reply_text(f"❌ Танк '{tank_name}' не найден")
            else:
                for result in results:
                    await show_tank_setup(update.message, result)
            context.user_data['waiting_for_tank_name'] = False
    except Exception as e:
        logger.error(f"Error in handle_tank_search: {e}")

async def show_tank_setup(message, tank_result):
    try:
        tank_name = tank_result["tank_name"]
        tank_class = tank_result["class"]
        tank_data = tank_result["data"]
        response = f"""🎯 {tank_name}
{tank_data['nation']} | {tank_class}

Доступные сборки:"""
        for setup in tank_data["setups"]:
            response += f"\n\n{setup['name']}\n{setup['equipment']}\n\n✨ Бонусы:\n{setup['bonus']}\n\n🎮 Стиль игры:\n{setup['playstyle']}"
        await message.reply_text(response, reply_markup=main_menu())
    except Exception as e:
        logger.error(f"Error in show_tank_setup: {e}")

async def handle_equipment(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        if update.message.text == "🎯База танков":
            await show_tank_classes(update.message)
        elif update.message.text in TANK_EQUIPMENT:
            await show_nations_menu(update.message, update.message.text, context)
        elif update.message.text == "🔙 Назад":
            await update.message.reply_text("🔙 Возврат в главное меню", reply_markup=main_menu())
    except Exception as e:
        logger.error(f"Error in handle_equipment: {e}")

async def show_tank_classes(message):
    try:
        await message.reply_text("🎯 Выберите класс техники:", reply_markup=tanks_menu())
    except Exception as e:
        logger.error(f"Error in show_tank_classes: {e}")

async def show_nations_menu(message, tank_class, context: ContextTypes.DEFAULT_TYPE):
    try:
        context.user_data['selected_class'] = tank_class
        tank_data = TANK_EQUIPMENT[tank_class]
        await message.reply_text(f"{tank_data['title']}\n{tank_data['description']}\n\nВыберите нацию:", reply_markup=nations_menu())
    except Exception as e:
        logger.error(f"Error in show_nations_menu: {e}")

async def handle_nation_selection(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        nation = update.message.text
        if nation == "🔙 Назад":
            await show_tank_classes(update.message)
            return
            
        nation_map = {
            "🇷🇺 СССР": "🇷🇺 СССР",
            "🇺🇸 США": "🇺🇸 США", 
            "🇩🇪 Германия": "🇩🇪 Германия",
            "🇬🇧 Великобритания": "🇬🇧 Великобритания",
            "🇫🇷 Франция": "🇫🇷 Франция",
            "🇯🇵 Япония": "🇯🇵 Япония",
            "🇨🇳 Китай": "🇨🇳 Китай",
            "🇨🇿 Чехия": "🇨🇿 Чехия",
            "🇵🇱 Польша": "🇵🇱 Польша",
            "🇸🇪 Швеция": "🇸🇪 Швеция",
            "🇮🇹 Италия": "🇮🇹 Италия",
            "⚙️ Сборная": "⚙️ Сборная"
        }
        
        if nation in nation_map:
            selected_class = context.user_data.get('selected_class')
            if selected_class:
                await show_tanks_by_nation(update.message, selected_class, nation_map[nation])
    except Exception as e:
        logger.error(f"Error in handle_nation_selection: {e}")

async def show_tanks_by_nation(message, tank_class, nation):
    try:
        tank_data = TANK_EQUIPMENT[tank_class]
        response = f"<b>{tank_data['title']} | {nation}</b>\n\n"
        
        tanks_in_nation = []
        for tank_name, tank_info in tank_data["tanks"].items():
            if tank_info["nation"] == nation:
                tanks_in_nation.append(tank_name)
        
        if tanks_in_nation:
            for tank in sorted(tanks_in_nation):
                response += f"• <code>{tank}</code>\n"
            response += f"\n🎯 Всего: {len(tanks_in_nation)} танков\n🔍 Используйте поиск оборудования для точных сборок"
        else:
            response = f"❌ В классе {tank_data['title']} нет танков нации {nation}"
        
        await message.reply_text(response, reply_markup=tanks_menu(), parse_mode='HTML')
    except Exception as e:
        logger.error(f"Error in show_tanks_by_nation: {e}")
        
async def handle_about(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("📊 Бот сборок оборудования для Мира Танков\n\nДоступно: 117 танков 10 уровня", reply_markup=main_menu())

async def handle_help(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("""❓ Помощь:

🎯 <b>Навигация по базе танков:</b>
• Выберите класс техники
• Выберите нацию 
• Скопируйте название(нажатием) танка для поиска

🔍 <b>Поиск оборудования:</b>
• Введите точное название танка
• Пример: <code>ИС-7</code>, <code>Объект 140</code>, <code>Leopard 1</code>

📊 <b>База данных:</b>
• 117 танков 10 уровня
•Сборки оборудования
• Рекомендации по стилю игры""", reply_markup=main_menu(), parse_mode='HTML')

async def handle_text(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        if context.user_data.get('waiting_for_tank_name'):
            await handle_tank_search(update, context)
            return
            
        nation_buttons = ["🇷🇺 СССР", "🇺🇸 США", "🇩🇪 Германия", "🇬🇧 Великобритания", 
                         "🇫🇷 Франция", "🇯🇵 Япония", "🇨🇳 Китай", "🇨🇿 Чехия", 
                         "🇵🇱 Польша", "🇸🇪 Швеция", "🇮🇹 Италия", "🔙 Назад"]
        
        if update.message.text in nation_buttons:
            await handle_nation_selection(update, context)
            return
            
        await update.message.reply_text("🤔 Используйте кнопки меню", reply_markup=main_menu())
    except Exception as e:
        logger.error(f"Error in handle_text: {e}")

def main():
    try:
        # Создаем Application вместо Updater
        application = Application.builder().token(BOT_TOKEN).build()
        
        # Добавляем обработчики
        application.add_handler(CommandHandler("start", start))
        application.add_handler(CommandHandler("help", handle_help))
        
        application.add_handler(MessageHandler(filters.Regex("^🎯База танков$"), handle_equipment))
        application.add_handler(MessageHandler(filters.Regex("^🔍Оборудование для танков$"), handle_search))
        application.add_handler(MessageHandler(filters.Regex("^📊 О боте$"), handle_about))
        application.add_handler(MessageHandler(filters.Regex("^❓ Помощь$"), handle_help))
        
        application.add_handler(MessageHandler(filters.Regex("^⚔️ Тяжёлые танки$"), handle_equipment))
        application.add_handler(MessageHandler(filters.Regex("^🎯 ПТ-САУ$"), handle_equipment))
        application.add_handler(MessageHandler(filters.Regex("^🚗 Лёгкие танки$"), handle_equipment))
        application.add_handler(MessageHandler(filters.Regex("^⚡ Средние танки$"), handle_equipment))
        application.add_handler(MessageHandler(filters.Regex("^🎆 Артиллерия$"), handle_equipment))
        application.add_handler(MessageHandler(filters.Regex("^🔙 Назад$"), handle_equipment))
        
        # Обработчики для наций
        nation_handlers = [
            "🇷🇺 СССР", "🇺🇸 США", "🇩🇪 Германия", "🇬🇧 Великобритания",
            "🇫🇷 Франция", "🇯🇵 Япония", "🇨🇳 Китай", "🇨🇿 Чехия", 
            "🇵🇱 Польша", "🇸🇪 Швеция", "🇮🇹 Италия"
        ]
        
        for nation in nation_handlers:
            application.add_handler(MessageHandler(filters.Regex(f"^{nation}$"), handle_nation_selection))
        application.add_handler(MessageHandler(filters.Regex("^⚙️ Сборная$"), handle_nation_selection))
                   
        application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_text))
        
        logger.info("✅ Бот запускается...")
        
        # Запускаем бота
        application.run_polling()
        
    except Exception as e:
        logger.error(f"Failed to start bot: {e}")

if __name__ == '__main__':
    main()
